---
import Icon from './Icon.astro';
import './Navbar.scss';
import SiteLogo from './SiteLogo.astro';

const normalizedPath = Astro.url.pathname.replace(/\/$/, '') || '/';
const isCurrentPath = (path: string) => {
  if (path === '/') {
    return normalizedPath === '/';
  }
  return normalizedPath === path || normalizedPath.startsWith(path + '/');
};
---

<header class="main">
    <div class="struct">
        <button id="menu-open" aria-label="Open menu">
          <Icon id="menu" width="30" height="30" />
        </button>
        <a class="link-logo" href="/">
            <!-- <img src="https://placehold.co/130x50" class="logo" alt="the13thgeek logo"> -->
            <!-- <img src="/assets/global/header-logo-default.png" width="130" class="logo" alt="the13thgeek logo"> -->
            <!-- <img src="/assets/global/the13thgeek-brand.svg" width="130" class="logo" alt="the13thgeek logo"> -->
            <SiteLogo />
        </a>
        <nav class="main-nav">
            <ul>
                <li class="menu-close-button">
                    <button id="menu-close" aria-label="Close menu">
                    <Icon id="close" width="30" height="30" />
                    </button>
                </li>
                <li><a class={isCurrentPath('/') ? 'active' : ''} href="/">Home</a></li>
                <li><a class={isCurrentPath('/about') ? 'active' : ''} href="/about">About</a></li>
                <li><a class={isCurrentPath('/projects') ? 'active' : ''} href="/projects">Projects</a></li>
                <li><a class={isCurrentPath('/field-notes') ? 'active' : ''} href="/field-notes">Field Notes</a></li>
                <li><a class={isCurrentPath('/twitch') ? 'active' : ''} href="/twitch">Twitch</a></li>
            </ul>
        </nav>
        <!-- <a class="link-connect" href="/#connect">Connect</a> -->
    </div>
</header>

<script is:inline>
  document.addEventListener("DOMContentLoaded", () => {
    const menuToggleOn = document.querySelector("#menu-open");
    const menuToggleOff = document.querySelector("#menu-close");
    const nav = document.querySelector("nav.main-nav");

    menuToggleOn?.addEventListener("click", () => {
      nav.classList.add("open");
    });
    menuToggleOff?.addEventListener("click", () => {
      nav.classList.remove("open");
    });
  });
</script>